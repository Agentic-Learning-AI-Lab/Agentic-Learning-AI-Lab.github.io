<!doctype html>
<html lang="en">
    {{> head}}
    <body class="tw-flex tw-min-h-[100vh] tw-flex-col tw-bg-[#fff] tw-font-mono">
        {{> header}} 

        <section class="tw-flex tw-w-full tw-flex-col tw-p-[5%] tw-mt-[150px] max-lg:tw-p-4">
            <h3 class="text-left tw-text-4xl tw-font-medium max-md:tw-text-2xl">
                contact
            </h3>
            <form id="contact-form" class="tw-space-y-4 tw-mt-[30px]">
        <div>
            <label for="name" class="tw-block tw-text-sm tw-font-medium tw-text-gray-700">name</label>
            <input type="text" id="name" name="name" required
                   class="tw-mt-1 tw-block tw-w-full tw-px-4 tw-py-2 tw-border tw-border-gray-300 tw-rounded-md tw-shadow-sm focus:tw-ring-blue-500 focus:tw-border-blue-500"/>
        </div>
        <div>
            <label for="email" class="tw-block tw-text-sm tw-font-medium tw-text-gray-700">email</label>
            <input type="email" id="email" name="email" required
                   class="tw-mt-1 tw-block tw-w-full tw-px-4 tw-py-2 tw-border tw-border-gray-300 tw-rounded-md tw-shadow-sm focus:tw-ring-blue-500 focus:tw-border-blue-500"/>
        </div>
        <div>
            <label for="message" class="tw-block tw-text-sm tw-font-medium tw-text-gray-700">message</label>
            <textarea id="message" name="message" rows="5" required
                      class="tw-mt-1 tw-block tw-w-full tw-px-4 tw-py-2 tw-border tw-border-gray-300 tw-rounded-md tw-shadow-sm focus:tw-ring-blue-500 focus:tw-border-blue-500"></textarea>
        </div>
        
        <!-- reCAPTCHA widget -->
        <div class="g-recaptcha" data-sitekey="6LeLXHcqAAAAAKjLueRN9QL5eTcF7hC6kLFcDZjC"></div>
        
        <button type="submit"
                class="tw-w-full tw-bg-blue-500 tw-text-white tw-font-semibold tw-py-2 tw-px-4 tw-rounded-md hover:tw-bg-blue-600 tw-transition tw-duration-200">
            Send Message
        </button>
        <p class="tw-text-green-600 tw-text-center tw-mt-4" id="success-message" style="display: none;">Your message has been sent!</p>
        <p class="tw-text-red-600 tw-text-center tw-mt-4" id="error-message" style="display: none;">There was an error sending your message. Please try again.</p>
    </form>
        </section>

        {{> footer}}
    </body>

    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/gsap.min.js"
        integrity="sha512-B1lby8cGcAUU3GR+Fd809/ZxgHbfwJMp0jLTVfHiArTuUt++VqSlJpaJvhNtRf3NERaxDNmmxkdx2o+aHd4bvw=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    ></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/ScrollTrigger.min.js"
        integrity="sha512-AY2+JxnBETJ0wcXnLPCcZJIJx0eimyhz3OJ55k2Jx4RtYC+XdIi2VtJQ+tP3BaTst4otlGG1TtPJ9fKrAUnRdQ=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    ></script>

    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@2.6.4/dist/email.min.js"></script>
    <script>
    (function(){
        emailjs.init({publicKey: "y6ebNBhEpEzmyqS8F",}); // Replace with your EmailJS user ID
    })();

    document.getElementById('contact-form').addEventListener('submit', function(event) {
        event.preventDefault();

        // Hide previous messages
        document.getElementById('success-message').style.display = 'none';
        document.getElementById('error-message').style.display = 'none';

        // Check if reCAPTCHA is completed
        if (grecaptcha.getResponse() === "") {
            document.getElementById('error-message').innerText = "Please complete the reCAPTCHA.";
            document.getElementById('error-message').style.display = 'block';
            return;
        }

        templateParams = {
            from_name: this.name,
            reply_to: this.email,
            message: this.message
        };

        // Send the email
        emailjs.sendForm('service_nyu', 'template_w5u7hym', templateParams)
            .then(function() {
                document.getElementById('success-message').style.display = 'block';
                document.getElementById('contact-form').reset();
                grecaptcha.reset(); // Reset reCAPTCHA after successful submission
            }, function(error) {
                document.getElementById('error-message').style.display = 'block';
                console.error('Failed to send the message:', error);
            });
    });
    </script>

    <script src="./index.js"></script>
</html>
